<% content_for :header_tags do %>
    <%= stylesheet_link_tag 'microblogging', :plugin => 'redmine_microblogging' %>
<% end %>

<div class="splitcontentleft">
  <%= link_to 'New post', new_post_path, :class => 'contextual icon icon-add' %>
  <h2>Listing posts</h2>

  <ol>
    <% @timeline.each do |line| %>
      <%= render :partial => 'line_item', :locals => { :line => line, :user => @user } %>
    <% end %>
  </ol>

  <br />

  <h3>Following</h3>
  <ul>
    <% for friendship in @user.friendships %>
      <li>
        <%=h friendship.friend.name %>
        <% if friendship.accepted %>
          (<%= link_to "unfollow", friendship, :method => :delete %>)
        <% elsif !friendship.blocked %>
          (pending)
        <% end %>
      </li>
    <% end %>
  </ul>

  <h3>Followers</h3>
  <ul>
    <% for friendship in @user.inverse_friendships %>
      <% if !friendship.blocked %>
        <li>
            <%=h friendship.user.name %>
            <% if !friendship.accepted %>
              (<%= link_to "accept", accept_friendship_path(friendship) %> | <%= link_to "reject", reject_friendship_path(friendship) %> )
            <% else %>
              (<%= link_to "block", block_friendship_path(friendship) %>)
            <% end %> <!-- IF Accepted -->
        </li>
      <% end %> <!-- IF Blocked -->
    <% end %> <!-- FOR -->
  </ul>
</div>

<div class="splitcontentright">
  <h3>Search Users</h3>
  <% form_tag posts_path, :method => 'get' do %>
    <p>
      <%= text_field_tag :search, params[:search] %>
      <%= submit_tag "Search", :name => nil %>
    </p>
  <% end %>

  <% if @search_results %>
    <%= render :partial => 'search_results', :locals => { :search_results => @search_results } %>
  <% end %>
</div>

